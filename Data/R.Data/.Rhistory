#Load libraries
library('ggplot2')
library(plotrix)
library(matrixStats)
#Load output of simulation
setwd("~/Documents/GitHub/Cayo-Maria-Disease-Modeling/Data/R.Data")
load("macaque_disease_simulation.RData")
############################
## Plot infection curves
#Pool data across years
years = c("2015","2016","2017","2018","2019","2021")
data.all=data.frame()
for (yr in c(1:6)){
df = simu_res_pinf[[yr]][['0.1']][[2]] #for p_infection = 0.1
mean.year = rowMeans(df)
sd.year = rowSds(as.matrix(df))
sem.year =apply(df, 1, std.error)
data = data.frame(mean=mean.year, sd =sd.year, sem=sem.year, timestep=1:nrow(df),year=years[yr])
data.all = rbind(data.all,data)
}
#Plot mean % population infected across simulation runs with SEMs
ggplot(data = data.all, aes(x=timestep, y = mean, color = year)) +
geom_smooth(size = 1) +
geom_smooth( aes(x=timestep, y = mean-sem, color = year), size = 0.3) +
geom_smooth( aes(x=timestep, y = mean+sem, color = year), size = 0.3) +
geom_ribbon(aes(y = mean, ymin = mean - sem, ymax = mean + sem, fill = year), alpha = .1) +
#geom_ribbon(aes(y = smooth.mean, ymin = smooth.mean - smooth.sd, ymax = smooth.mean + smooth.sd, fill = year), alpha = .2) +
xlab("Time step")+ylab("% population infected")+
theme_light(base_size = 12)+
xlim(c(0,1000))+ ylim(c(0,1))
ggplot(data = data.all, aes(x=timestep, y = mean, color = year)) +
geom_smooth(size = 1) +
geom_smooth( aes(x=timestep, y = mean-sd, color = year), size = 0.3) +
geom_smooth( aes(x=timestep, y = mean+sd, color = year), size = 0.3) +
geom_ribbon(aes(y = mean, ymin = mean - sd, ymax = mean + sd, fill = year), alpha = .1) +
#geom_ribbon(aes(y = smooth.mean, ymin = smooth.mean - smooth.sd, ymax = smooth.mean + smooth.sd, fill = year), alpha = .2) +
xlab("Time step")+ylab("% population infected")+
theme_light(base_size = 12)+
xlim(c(0,1000))+ ylim(c(0,1))
